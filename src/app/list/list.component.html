<xont-ventura-message-prompt #msgPrompt></xont-ventura-message-prompt>

<xont-ventura-collapsible
  id="collapse1"
  targetElementID="selectionCriteria"
  [collapsed]="searchForm.get('Collapsed')?.value"
  (onChange)="
    searchForm.patchValue({ Collapsed: !searchForm.get('Collapsed')?.value })
  "
>
</xont-ventura-collapsible>

<div
  id="selectionCriteria"
  class="collapse"
  [class.collapsed]="searchForm.get('Collapsed')?.value"
>
  <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
    <table>
      <tbody>
        <tr>
          <td width="120">
            <span class="Captionstyle">Executive Code</span>
          </td>
          <td>
            <input
              formControlName="ExecutiveCode"
              type="text"
              class="Textboxstyle"
              style="width: 120px"
              maxlength="10"
            />
          </td>
        </tr>
        <tr>
          <td width="120">
            <span class="Captionstyle">Executive Name</span>
          </td>
          <td>
            <input
              formControlName="ExecutiveName"
              type="text"
              class="Textboxstyle"
              style="width: 320px"
              maxlength="50"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <table>
      <tbody>
        <tr>
          <td width="120">
            <span class="Captionstyle">Territory</span>
          </td>
          <td>
            <xont-ventura-list-prompt
              name="lpmtTerritory"
              [maxLengths]="[4, 50]"
              [inputWidths]="[120, 320]"
              [gridHeaders]="['Territory Code', 'Description']"
              [gridFields]="['masterGroupValue', 'masterGroupValueDescription']"
              [mandatory]="false"
              [type]="'territory'"
              [status]="'All'"
              [strict]="true"
              [control]="searchForm"
              [modelProps]="['territoryCode', 'territoryDesc']"
              [dataFields]="['masterGroupValue', 'masterGroupValueDescription']"
            >
            </xont-ventura-list-prompt>
          </td>
        </tr>
        <tr>
          <td width="120">
            <span class="Captionstyle">Operation Type</span>
          </td>
          <td>
            <xont-ventura-list-prompt
              name="lpmtOptType"
              #lpmtOptType
              [maxLengths]="[2, 50]"
              [inputWidths]="[120, 320]"
              [gridHeaders]="['Code', 'Description']"
              [gridFields]="['code', 'description']"
              [mandatory]="false"
              [strict]="true"
              (onDataBind)="lpmtOptType_DataBind()"
              [control]="searchForm"
              [modelProps]="['operationType', 'operationTypeDesc']"
              [dataFields]="['code', 'description']"
            >
            </xont-ventura-list-prompt>
          </td>
        </tr>
      </tbody>
    </table>

    <xont-ventura-classification-selector
      #clsExecutive
      [id]="cls1.ID"
      [taskCode]="cls1.TaskCode"
      [classificationType]="cls1.Type"
      [labelWidth]="cls1.LabelWidth"
      [enableUserInput]="cls1.EnableUserInput"
      [codeTextWidth]="cls1.CodeTextWidth"
      [descriptionTextWidth]="cls1.DescriptionTextWidth"
      [activeStatus]="cls1.ActiveStatus"
      [allMandatory]="cls1.AllMandatory"
      [lastLevelRequired]="cls1.LastLevelRequired"
    >
    </xont-ventura-classification-selector>

    <table>
      <tbody>
        <tr>
          <td width="120">&nbsp;</td>
          <td>
            <fieldset style="width: 300px">
              <legend class="GridCaptionstyle">Search type</legend>
              <table>
                <tbody>
                  <tr>
                    <td>
                      <span class="Captionstyle">
                        <input
                          type="radio"
                          formControlName="SearchType"
                          value="startWith"
                          id="optStartWith"
                        />
                        <label for="optStartWith">Start with</label>
                      </span>
                    </td>
                    <td>&nbsp;</td>
                    <td>
                      <span class="Captionstyle">
                        <input
                          type="radio"
                          formControlName="SearchType"
                          value="anyWhere"
                          id="optAnyWhereInText"
                        />
                        <label for="optAnyWhereInText">Anywhere in text</label>
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </fieldset>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <span class="Checkboxstyle" style="padding-left: 4px">
              <input
                type="checkbox"
                formControlName="ActiveOnly"
                id="chkActiveOnly"
              />
              <label for="chkActiveOnly">Active only</label>
            </span>
          </td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td>
            <button type="submit" class="MainButtonStyle">List</button>
            <button type="button" (click)="onReset()" class="MainButtonStyle">
              Reset
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </form>
</div>

<div>
  <xont-ventura-gridexport [gridId]="gridID1" [gridName]="gridName1">
  </xont-ventura-gridexport>
</div>

@if (noDataFound()) {
<span class="Labelstyle">No data found for the given criteria</span>
} @if (isLoading()) {
<div class="loading-overlay">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>
}

<div class="DataTableContainer">
  @if (hasData()) {
  <table id="tblExecutive" class="DataTableStyle HeaderFreezeStyle">
    <thead>
      <tr>
        <th style="width: 8%" (click)="onSort('ExecutiveCode')">
          Executive Code @if (sortBy === 'ExecutiveCode') {
          <span class="sort-icon">{{ sortOrder === "asc" ? "▲" : "▼" }}</span>
          }
        </th>
        <th style="width: 12%" (click)="onSort('ExecutiveName')">
          Executive Name @if (sortBy === 'ExecutiveName') {
          <span class="sort-icon">{{ sortOrder === "asc" ? "▲" : "▼" }}</span>
          }
        </th>
        <th style="width: 15%" (click)="onSort('UserProfileName')">
          User Profile Name @if (sortBy === 'UserProfileName') {
          <span class="sort-icon">{{ sortOrder === "asc" ? "▲" : "▼" }}</span>
          }
        </th>
        <th style="width: 15%" (click)="onSort('TerritoryName')">
          Territory @if (sortBy === 'TerritoryName') {
          <span class="sort-icon">{{ sortOrder === "asc" ? "▲" : "▼" }}</span>
          }
        </th>
        <th style="width: 10%" (click)="onSort('OperationTypeDesc')">
          Operation Type @if (sortBy === 'OperationTypeDesc') {
          <span class="sort-icon">{{ sortOrder === "asc" ? "▲" : "▼" }}</span>
          }
        </th>
        <th style="width: 8%">Options</th>
      </tr>
    </thead>
    <tbody>
      @for (item of executiveDataset(); track trackByExecutiveCode($index,
      item)) {
      <tr [ngClass]="{ deactiveRow: item.Status === 0 }">
        <td style="width: 8%">{{ item.ExecutiveCode }}</td>
        <td style="width: 12%">{{ item.ExecutiveName }}</td>
        <td style="width: 15%">{{ item.UserProfileName }}</td>
        <td style="width: 15%">{{ item.TerritoryName }}</td>
        <td style="width: 10%">{{ item.OperationTypeDesc }}</td>
        <td style="width: 8%">
          <a (click)="newBasedOn_OnClick(item)">NewBasedOn |</a>
          <a (click)="edit_OnClick(item)">Edit</a>
        </td>
      </tr>
      }
    </tbody>
    <tfoot>
      <tr>
        <td colspan="6">
          <xont-ventura-gridloader
            #gridLoader
            (onChange)="gridLoader_OnChange()"
          >
          </xont-ventura-gridloader>
        </td>
      </tr>
    </tfoot>
  </table>
  }
</div>

<div>
  <button (click)="btnNew_OnClick()" class="MainButtonStyle">New</button>
  <button (click)="closeTab()" class="MainButtonStyle">Exit</button>
</div>
